<div class="min-h-screen bg-dark-950">
  <!-- Navigation -->
  <app-navbar></app-navbar>
  
  <div class="claim-container">
    <header class="claim-header">
      <div class="flex items-center space-x-4">
        <button (click)="goBack()" class="back-btn">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
          </svg>
          Back
        </button>
        <h1>Submit Claim</h1>
      </div>
      <div class="user-info">
        <span>Welcome, {{ user?.name }}!</span>
      </div>
    </header>

  <div class="claim-content">
    <div class="claim-form-section">
      <h2>Claim Information</h2>
      
      <form (ngSubmit)="submitClaim()" class="claim-form">
        <div class="form-group">
          <label for="userPolicyId">Select Policy *</label>
          <select 
            id="userPolicyId" 
            [(ngModel)]="claimData.userPolicyId" 
            name="userPolicyId" 
            required
          >
            <option value="">Select a policy</option>
            <option 
              *ngFor="let policy of userPolicies" 
              [value]="policy._id"
            >
              {{ policy.policyProductId?.title }} - {{ policy.policyProductId?.code }}
            </option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="incidentDate">Incident Date *</label>
          <input 
            id="incidentDate" 
            [(ngModel)]="claimData.incidentDate" 
            name="incidentDate" 
            type="date" 
            required 
          />
        </div>
        
        <div class="form-group">
          <label for="description">Description *</label>
          <textarea 
            id="description" 
            [(ngModel)]="claimData.description" 
            name="description" 
            placeholder="Describe the incident in detail..."
            rows="4"
            required
          ></textarea>
        </div>
        
        <div class="form-group">
          <label for="amountClaimed">Amount Claimed ($) *</label>
          <input 
            id="amountClaimed" 
            [(ngModel)]="claimData.amountClaimed" 
            name="amountClaimed" 
            type="number" 
            step="0.01" 
            min="0" 
            placeholder="Enter claim amount"
            required 
          />
        </div>
        
        <div class="form-actions">
          <button type="button" class="btn btn-secondary" (click)="resetForm()">Reset</button>
          <button type="submit" class="btn btn-primary" [disabled]="submitting">
            {{ submitting ? 'Submitting...' : 'Submit Claim' }}
          </button>
        </div>
      </form>
    </div>

    <div class="policies-section" *ngIf="userPolicies.length > 0">
      <h2>Your Active Policies</h2>
      
      <div class="policies-grid">
        <div class="policy-card" *ngFor="let policy of userPolicies">
          <div class="policy-header">
            <h3>{{ policy.policyProductId?.title }}</h3>
            <span class="policy-code">{{ policy.policyProductId?.code }}</span>
          </div>
          
          <div class="policy-details">
            <div class="policy-info">
              <div class="info-item">
                <span class="label">Premium Paid:</span>
                <span class="value">${{ policy.premiumPaid }}</span>
              </div>
              <div class="info-item">
                <span class="label">Start Date:</span>
                <span class="value">{{ policy.startDate | date:'short' }}</span>
              </div>
              <div class="info-item">
                <span class="label">End Date:</span>
                <span class="value">{{ policy.endDate | date:'short' }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="empty-state" *ngIf="userPolicies.length === 0 && !loading">
      <div class="empty-icon">ðŸ“‹</div>
      <h3>No Policies Available for Claims</h3>
      <p>You can only submit claims for policies that have been assigned an agent by the admin.</p>
      <p>Please contact the admin to assign an agent to your purchased policies.</p>
      <button class="btn btn-primary" (click)="goBack()">Go to Dashboard</button>
    </div>

    <div class="loading-state" *ngIf="loading">
      <div class="spinner"></div>
      <p>Loading your policies...</p>
    </div>
  </div>
  </div>
</div>
